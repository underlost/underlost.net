---
layout: posts
title: Welcome to the new Underlost
slug: new-underlost
date: 2014-04-03
snippet: "Introducing the new, and improved underlost.net. I spent the last couple months constantly developing and improving it, and I'm finally happy with the results."
---

<p class="lead">Introducing the new, and improved underlost.net. I spent the last couple months constantly developing and improving it, and I'm finally happy with the results.</p>

### Development

While I wrote Replica, you would think I'd have just used that to power the site. However, I felt having a full blown content management system was a little out of place. It was simply overkill. I don't really update the site that often, and really all I need was a static site to host a few dozen HTML files. I dodnt need anything too fancy, nothing dynamic, and surely not a database to house all the content. Enter Jekyll. For those unfamilar, Jekyll is a static site generator written in Ruby. I've had experience with using it to an extent deploying sites on Github. It also uses a liquid template system, similar to what Django uses for it's own templates, so naturally I felt right at home.

Now, I understand my site is a bit peculiar in the way things are setup. Instead of using jekyll's built in generator for blog posts, I rely on my own YML file for maintaining the blog data. '_posts' is reserved for generating the content for the project pages. Why not the other way around? I had thought about this at first too, but after some trial and error, this method is just simpler. Not all posts will use the same layouts, and this way I can keep assets for certain posts a little more organized instead of dumping it all in ta single directory. I still maintain a data file for projects as well, for the mobile /projects/ page.


### Deployment

While building underlost.net, since I was doing all the work locally, I wasnt really sure where I wanted to host it yet. With it being a set of static html, I had several options. Being a stickler for keeping backups, I did the only viable option; deploy everywhere! Right out of the box, I knew WEBrick (the default server Jekyll uses) isn't ideal for production. So I switched it out for Unicorn and Memcache. Using a slightly modified buildpack, I can simply push the main git repo to Heroku.

The only problem with that is, Heroku can become expensive quickly, and using them to serve static html is a bit overkill. The next option I looked at was Github Pages. The issue here is it requires me to setup separate repo within, pushing the contents of '_site' to Github and serving it over githup pages. Why not just push the entire repo? Github doesn't allow custom plugins, nor an alternate "source" directory inside '_config.yml'. Using a little Grunt magic, I can eliminate most of the work of maintaining a separate repo, but more on this shortly. The third, and my preferred option, uses the s3_website gem. With a single command, I can push the site to an Amazon S3 bucket. There's plenty of sites that document how to do this already, so I won't really get into it.

Now let's backup to Grunt. Not really being into Node.Js, I dismissed the task manager at first. It wasnt until I learned to use it at work had I realized the capabilities of Node, not just as a backend, but as a tool for front end development as well. So how does the website use Grunt? I've setup a number of tasks for it actually. What are they? In order of execution:

* Compile LESS to CSS
* Run autoprefixer on CSS to add vendor prefixes to CSS rules where needed
* Compile all JS files into a single file
* Minify CSS/JS
* Run validation tests on HTML generated by Jekyll
* Deploy the compiled '_site' diectory to Github

The only grunt task I have yet to work out is a _good_ way to deply to S3. Until then, I'll rely on the ruby gem to get the job done.
